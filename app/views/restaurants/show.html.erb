<div class="row">
	<div class="col-md-3">
		<%= image_tag @restaurant.image_url %>
		<p>
			<h3>
				<%= @restaurant.name %>
			</h3>
			<div class="star-rating" data-score=<%= @avg_rating %> ></div>
			<% if !@reviews.blank? %>
				<%= pluralize(@reviews.size, 'review') %>
			<% end %>
		</p>
		<p>
		  <strong>Address:</strong>
		  <%= @restaurant.address %>
		</p>
		<p>
		  <strong>Phone:</strong>
		  <%= @restaurant.phone %>
		</p>
		<p>
		  <strong>Website:</strong>
		  <%= link_to @restaurant.website, @restaurant.website %>
		</p>
		<p>
			<%= link_to 'Write a review', new_restaurant_review_path(@restaurant), class:'btn btn-primary' %>
		</p>
		<P>
			<%= link_to 'Edit', edit_restaurant_path(@restaurant), class:'btn btn-link' %> |
			<%= link_to 'Back', restaurants_path, class:'btn btn-link' %>
		</P>
		
	</div>
	<div class="col-md-9">
		<% if @reviews.blank? %>
			<h3>No reviews for this restaurant. Be the first one to write review</h3>
		<% else %>
		<table class='table'>
			<thead>
				<tr>
					<th class="col-md-2"></th>
					<th class="col-md-10"></th>
				</tr>
			</thead>
			<tbody>
				<% @reviews.each do |review| %>
				<tr>
					<td>
						<h4> <%= "#{review.user.first_name.to_s.capitalize} #{review.user.last_name.to_s.capitalize[0]}" %> </h4>
						<p> <%= "#{review.created_at.strftime('%y-%m-%d') }" %> </p>
					</td>
					<td>
						<div class="star-rating" data-score=<%= review.rating %> ></div>
						<p><%= h(review.comment).gsub(/\n/, '<br>').html_safe %></p>
						<% if user_signed_in? %>
							<% if (review.user == current_user) || (current_user.admin?) %>
								<%= link_to "Edit", edit_restaurant_review_path(@restaurant, review) %>
								<%= link_to "Delete", restaurant_review_path(@restaurant, review), method: :delete %>
							<% end %>
						<% end %>
					</td>
				</tr>
				<% end %>
			</tbody>
		</table>
		<% end %>

	</div>
</div>
<script>
	$('.star-rating').raty({
		path: 'https://s3.amazonaws.com/raty-star',
    score: function() {
      return $(this).attr('data-score');
    },
    readOnly: true
	});
</script>